import{c as I}from"./config-0fcvTnOY.js";import{k as E,d as D,r as g,q as L,v as O,m as G,l as k,w as d,o as p,b as l,a as s,t as U,V as _,x as V,j as $,f as A,y as H,h as J,c as z,e as K,u as f,z as x}from"./index-BBymKEWy.js";import{M}from"./Template-DR9MoYn1.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as W}from"./search-B_vgYZko.js";import{I as b}from"./check-Cqxn2yYp.js";async function X(){try{const u=await I.get("/api/v1/auth/admin/staff",{headers:{Authorization:`Bearer ${E("accessToken")}`,"Content-Type":"application/json"}});return u==null?void 0:u.data}catch{return null}}async function Y(u){try{const i=await I.post("/api/v1/auth/admin/staff",u,{headers:{Authorization:`Bearer ${E("accessToken")}`,"Content-Type":"application/json"}});return i==null?void 0:i.data}catch{return null}}async function ee(u){try{const i=await I.delete(`/api/v1/auth/admin/staff/${u}`,{headers:{Authorization:`Bearer ${E("accessToken")}`,"Content-Type":"application/json"}});return i==null?void 0:i.data}catch{return null}}async function se(u,i){try{const v=await I.post(`/api/v1/auth/admin/staff/${u}`,i,{headers:{Authorization:`Bearer ${E("accessToken")}`,"Content-Type":"application/json"}});return v==null?void 0:v.data}catch{return null}}const ae={class:"modal-add-admin__content"},te={class:"modal-add-admin__title"},le={class:"modal-add-admin__form"},ie={class:"modal-add-admin__checkboxes"},ne={class:"modal-add-admin-checkbox"},oe={class:"modal-add-admin-checkbox"},de={class:"modal-add-admin-checkbox"},me={class:"modal-add-admin-checkbox"},re={class:"modal-add-admin-checkbox"},ue={class:"modal-add-admin-checkbox"},pe={class:"modal-add-admin-checkbox"},ve={class:"modal-add-admin-checkbox"},ce={class:"modal-add-admin-checkbox"},fe={class:"modal-add-admin-checkbox"},ke={class:"modal-add-admin__buttons"},he=D({__name:"ModalAddEmployee",props:{active:{type:Boolean},modalIsAdd:{type:Boolean},selectAdmin:{}},emits:["close","create"],setup(u,{emit:i}){const v=i,h=u,a=g(h.selectAdmin),n=L("form"),w={email:[m=>m?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(m)||"Некорректный email":"Заполните поле"],name:[m=>{if(!m&&h.modalIsAdd)return"Заполните поле"}],password:[m=>{if(!m&&h.modalIsAdd)return"Заполните поле"}]},y=async()=>{const{valid:m}=await n.value.validate();m&&(v("create",a.value),v("close"))};return O(()=>{a.value={}}),G(()=>h.selectAdmin,m=>{a.value=m}),(m,e)=>(p(),k(M,{onClose:e[16]||(e[16]=t=>m.$emit("close")),active:m.active,class:"modal-add-admin"},{default:d(()=>[l(J,{ref_key:"form",ref:n,"fast-fail":"",onSubmit:e[15]||(e[15]=H(()=>{},["prevent"]))},{default:d(()=>[s("div",ae,[s("h2",te,U(m.modalIsAdd?"Добавление сотрудника":"Редактирование сотрудника"),1),s("div",le,[l(_,{rules:w.password,modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.name=t),density:"compact",height:"32px",label:"Имя"},null,8,["rules","modelValue"]),l(_,{modelValue:a.value.surname,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.surname=t),density:"compact",height:"32px",label:"Фамилия"},null,8,["modelValue"]),l(_,{rules:w.email,modelValue:a.value.email,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.email=t),density:"compact",height:"32px",label:"Email"},null,8,["rules","modelValue"]),l(_,{rules:w.password,modelValue:a.value.password,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.password=t),density:"compact",height:"32px",label:m.modalIsAdd?"Пароль":"Новый пароль"},null,8,["rules","modelValue","label"])]),s("ul",ie,[s("li",ne,[e[17]||(e[17]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Дашборд")],-1)),l(V,{modelValue:a.value.permissions.dashboard,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.permissions.dashboard=t),"hide-details":""},null,8,["modelValue"])]),s("li",oe,[e[18]||(e[18]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Статистика")],-1)),l(V,{modelValue:a.value.permissions.statistics,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.permissions.statistics=t),"hide-details":""},null,8,["modelValue"])]),s("li",de,[e[19]||(e[19]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Рейтинг")],-1)),l(V,{modelValue:a.value.permissions.rating,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.permissions.rating=t),"hide-details":""},null,8,["modelValue"])]),s("li",me,[e[20]||(e[20]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Участники")],-1)),l(V,{modelValue:a.value.permissions.participants,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.permissions.participants=t),"hide-details":""},null,8,["modelValue"])]),s("li",re,[e[21]||(e[21]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Блокировка")],-1)),l(V,{modelValue:a.value.permissions.block,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.permissions.block=t),"hide-details":""},null,8,["modelValue"])]),s("li",ue,[e[22]||(e[22]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"VIP")],-1)),l(V,{modelValue:a.value.permissions.vipRead,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.permissions.vipRead=t),"hide-details":""},null,8,["modelValue"])]),s("li",pe,[e[23]||(e[23]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Начисление VIP")],-1)),l(V,{modelValue:a.value.permissions.vipAdd,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.permissions.vipAdd=t),"hide-details":""},null,8,["modelValue"])]),s("li",ve,[e[24]||(e[24]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Сотрудники")],-1)),l(V,{modelValue:a.value.permissions.staffRead,"onUpdate:modelValue":e[11]||(e[11]=t=>a.value.permissions.staffRead=t),"hide-details":""},null,8,["modelValue"])]),s("li",ce,[e[25]||(e[25]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Редактирование сотрудников")],-1)),l(V,{modelValue:a.value.permissions.staffEdit,"onUpdate:modelValue":e[12]||(e[12]=t=>a.value.permissions.staffEdit=t),"hide-details":""},null,8,["modelValue"])]),s("li",fe,[e[26]||(e[26]=s("div",{class:"modal-add-admin-checkbox__text"},[s("h3",null,"Создание/удаление сотрудников")],-1)),l(V,{modelValue:a.value.permissions.staffDelete,"onUpdate:modelValue":e[13]||(e[13]=t=>a.value.permissions.staffDelete=t),"hide-details":""},null,8,["modelValue"])])])]),s("div",ke,[l($,{onClick:e[14]||(e[14]=t=>m.$emit("close"))},{default:d(()=>e[27]||(e[27]=[A(" Отмена ")])),_:1}),l($,{type:"submit",onClick:y},{default:d(()=>e[28]||(e[28]=[A(" Создать ")])),_:1})])]),_:1},512)]),_:1},8,["active"]))}}),ye={class:"modal-add-vip__content"},Ve={class:"modal-add-vip__title-text"},xe={class:"modal-add-vip__buttons"},be=D({__name:"ModalDeleteEmployee",props:{active:{type:Boolean},email:{},name:{},surname:{}},emits:["close","delete"],setup(u,{emit:i}){const v=i;function h(){v("delete"),v("close")}return(a,n)=>(p(),k(M,{onClose:n[1]||(n[1]=w=>a.$emit("close")),active:a.active,class:"modal-add-vip"},{default:d(()=>[s("div",ye,[s("div",Ve,[s("p",null,[n[2]||(n[2]=A(" Вы действительно хотите ")),n[3]||(n[3]=s("b",null,"удалить",-1)),n[4]||(n[4]=A(" адмнистратора ")),s("b",null,U(a.name+" "+a.surname),1),n[5]||(n[5]=A(" (email: ")),s("b",null,U(a.email),1),n[6]||(n[6]=A(")? "))])])]),s("div",xe,[l($,{onClick:n[0]||(n[0]=w=>a.$emit("close"))},{default:d(()=>n[7]||(n[7]=[A(" Отмена ")])),_:1}),l($,{onClick:h},{default:d(()=>n[8]||(n[8]=[A(" Да ")])),_:1})])]),_:1},8,["active"]))}}),we=Q(be,[["__scopeId","data-v-8a4103c8"]]),Ae={xmlns:"http://www.w3.org/2000/svg",width:"19",height:"19",fill:"none"};function ge(u,i){return p(),z("svg",Ae,i[0]||(i[0]=[s("path",{fill:"#000",d:"M18.21 4.54c.39-.39.39-1.04 0-1.41L15.87.79C15.5.4 14.85.4 14.46.79l-1.84 1.83 3.75 3.75zM.5 14.75v3.75h3.75L15.31 7.43l-3.75-3.75z"},null,-1)]))}const _e={render:ge},$e={xmlns:"http://www.w3.org/2000/svg",width:"17",height:"19",fill:"none"};function Ce(u,i){return p(),z("svg",$e,i[0]||(i[0]=[s("path",{fill:"#1C1B1F",d:"M3.5 18.5q-.824 0-1.412-.587A1.93 1.93 0 0 1 1.5 16.5v-13h-1v-2h5v-1h6v1h5v2h-1v13q0 .824-.588 1.413a1.93 1.93 0 0 1-1.412.587zm10-15h-10v13h10zm-8 11h2v-9h-2zm4 0h2v-9h-2z"},null,-1)]))}const Ie={render:Ce},Ee={class:"page-content"},Ue={class:"content employees-wrapper"},De={class:"title-block"},ze={class:"actions"},Be={class:"employees-btn-wrapper"},Pe=D({__name:"Employees",setup(u){const i=g(""),v=g([]),h=g(!1),a=g(!1),n=g(!0),w={email:"",password:"",name:"",surname:"",permissions:{dashboard:!1,statistics:!1,rating:!1,participants:!1,block:!1,vipRead:!1,vipAdd:!1,staffRead:!1,staffEdit:!1,staffDelete:!1,staffCreate:!1}},y=g(w),m=[{title:"Имя",key:"name",width:"110px"},{title:"Фамилия",key:"surname",width:"110px"},{title:"Дашборд",key:"permissions.dashboard",width:"90px",align:"center"},{title:"Статистика",key:"permissions.statistics",width:"90px",align:"center"},{title:"Рейтинг",key:"permissions.rating",width:"90px",align:"center"},{title:"Участники",key:"permissions.participants",width:"90px",align:"center"},{title:"Блокировка",key:"permissions.block",width:"90px",align:"center"},{title:"VIP",key:"permissions.vipRead",width:"90px",align:"center"},{title:"Начисление VIP",key:"permissions.vipAdd",width:"90px",align:"center"},{title:"Сотрудники",key:"permissions.staffRead",width:"80px",align:"center"},{title:"Редактирование сотрудников",key:"permissions.staffEdit",width:"80px",align:"center"},{title:"Создание/удаление сотрудников",key:"permissions.staffDelete",width:"180px",align:"center"},{title:"Действия",key:"actions",width:"90px"}];async function e(r){await Y(r),C()}function t(r){y.value=v.value.find(c=>(c==null?void 0:c.id)===r)}function S(){h.value=!1,y.value=w}function j(r){a.value=!0,t(r)}function N(r){n.value=!1,t(r),h.value=!0}function P(){y.value=w,n.value=!0,h.value=!0}async function F(r){var c;await se((c=y.value)==null?void 0:c.id,r),C()}async function q(){var r;await ee((r=y.value)==null?void 0:r.id),C()}async function C(){const r=await X();v.value=r==null?void 0:r.staff}return C(),(r,c)=>{var B,R,T;return p(),z("div",Ee,[s("section",Ue,[s("div",De,[l(_,{"hide-details":"",modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=o=>i.value=o),class:"search-input","max-width":"470",label:"Search",variant:"underlined"},{"append-inner":d(()=>[l(f(W))]),_:1},8,["modelValue"])]),l(K,{headers:m,items:v.value,search:i.value},{"item.permissions.dashboard":d(({item:o})=>[o.permissions.dashboard?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.statistics":d(({item:o})=>[o.permissions.statistics?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.rating":d(({item:o})=>[o.permissions.rating?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.participants":d(({item:o})=>[o.permissions.participants?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.block":d(({item:o})=>[o.permissions.block?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.vipRead":d(({item:o})=>[o.permissions.vipRead?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.vipAdd":d(({item:o})=>[o.permissions.vipAdd?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.staffRead":d(({item:o})=>[o.permissions.staffRead?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.staffEdit":d(({item:o})=>[o.permissions.staffEdit?(p(),k(f(b),{key:0})):x("",!0)]),"item.permissions.staffDelete":d(({item:o})=>[o.permissions.staffDelete?(p(),k(f(b),{key:0})):x("",!0)]),"item.actions":d(({item:o})=>[s("div",ze,[l(f(_e),{onClick:Z=>N(o.id),class:"icon-pen"},null,8,["onClick"]),l(f(Ie),{onClick:Z=>j(o.id),class:"icon-delete"},null,8,["onClick"])])]),_:1},8,["items","search"])]),s("div",Be,[l($,{onClick:P},{default:d(()=>c[2]||(c[2]=[A("Добавить")])),_:1})]),l(he,{onUpdate:F,onCreate:e,onClose:S,modalIsAdd:n.value,selectAdmin:y.value,active:h.value},null,8,["modalIsAdd","selectAdmin","active"]),l(we,{onDelete:q,onClose:c[1]||(c[1]=o=>a.value=!1),active:a.value,email:(B=y.value)==null?void 0:B.email,name:(R=y.value)==null?void 0:R.name,surname:(T=y.value)==null?void 0:T.surname},null,8,["active","email","name","surname"])])}}});export{Pe as default};
